!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("preact")):"function"==typeof define&&define.amd?define(["preact"],e):n.animate=e(n.preact)}(this,function(n){"use strict";function e(n,e){function t(){this.constructor=n}for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}function t(n,e,t){return null==n?null:(t&&t!==n&&(e=e.bind(t)),Array.prototype.map.call(n,e))}function i(n,e,t){return null==n?null:(t&&t!==n&&(e=e.bind(t)),Array.prototype.forEach.call(n,e))}function r(n,e){var t=null;return i(n,function(n){t||n&&n.key===e&&(t=n)}),t}function o(n,e,t){var r=null;return i(n,function(n){if(n&&n.key===e&&n.attributes[t]){if(r)throw new Error("two child with same key for <Animate> children");r=n}}),r}function a(n,e,t){var r=n.length===e.length;return r&&i(n,function(n,i){var o=e[i];n&&o&&(n&&!o||!n&&o?r=!1:n.key!==o.key?r=!1:t&&n.attributes[t]!==o.attributes[t]&&(r=!1))}),r}function s(n,e){var t=[],o={},a=[];return i(n,function(n){n&&r(e,n.key)?a.length&&(o[n.key]=a,a=[]):a.push(n)}),i(e,function(n){n&&o.hasOwnProperty(n.key)&&(t=t.concat(o[n.key])),t.push(n)}),t=t.concat(a)}function p(n){return n&&n instanceof L}function l(n,e,t,i){var a=n&&r(e,i),s=!1;if(t){var p=n.attributes[t];a?!o(e,i,t)&&p&&(s=!0):p&&(s=!0)}else a||(s=!0);return s}function c(n,e,t){n.addEventListener(e,t,!1)}function u(n,e,t){n.removeEventListener(e,t,!1)}function f(n,e){for(var t=window.getComputedStyle(n,null),i="",r=0,o=N;r<o.length;r++){var a=o[r];if(i=t.getPropertyValue(a+e))break}return i}function d(n){if(O){var e=parseFloat(f(n,"transition-delay"))||0,t=parseFloat(f(n,"transition-duration"))||0,i=parseFloat(f(n,"animation-delay"))||0,r=parseFloat(f(n,"animation-duration"))||0,o=Math.max(t+e,r+i);n.rcEndAnimTimeout=setTimeout(function(){n.rcEndAnimTimeout=null,n.rcEndListener&&n.rcEndListener()},1e3*o+200)}}function h(n){n.rcEndAnimTimeout&&(clearTimeout(n.rcEndAnimTimeout),n.rcEndAnimTimeout=null)}function y(n,e,t,i){var r=void 0===e?"undefined":"object"==typeof e,o=r?e.name:e,a=r?e.active:e+"-active",s=t,p=void 0,l=void 0,c=new D(n);return t&&"[object Object]"===Object.prototype.toString.call(t)&&(s=t.end,p=t.start,l=t.active),n.rcEndListener&&n.rcEndListener(),n.rcEndListener=function(e){e&&e.target!==n||(n.rcAnimTimeout&&(clearTimeout(n.rcAnimTimeout),n.rcAnimTimeout=null),h(n),c.remove(o),c.remove(a),i&&C.removeEndEventListener(n,n.rcEndListener),n.rcEndListener=null,s&&s())},i&&C.addEndEventListener(n,n.rcEndListener),p&&p(),c.add(o),n.rcAnimTimeout=setTimeout(function(){n.rcAnimTimeout=null,c.add(a),l&&setTimeout(l,0),i&&d(n)},30),{stop:function(){n.rcEndListener&&n.rcEndListener()}}}function v(n){return"function"==typeof A.findDOMNode?A.findDOMNode(n):n.base||n}function m(e){var t=[];return i(e.children,function(e){p(e)&&(e.key||(e=n.cloneElement(e,{key:M})),t.push(e))}),t}function E(){}var A="default"in n?n.default:n;const g=Object.assign||function(n){for(var e,t=1;t<arguments.length;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n};var L=n.h("a",null).constructor,k=/\s+/,w=Object.prototype.toString,b=function(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0;t<n.length;++t)if(n[t]===e)return t;return-1},D=function(){function n(n){if(!n||!n.nodeType)throw new Error("A DOM element reference is required");this.el=n,this.list=n.classList}return n.prototype.add=function(n){if(this.list)return this.list.add(n),this;var e=this.array();return-1===b(e,n)&&e.push(n),this.el.className=e.join(" "),this},n.prototype.remove=function(n){if("[object RegExp]"===w.call(n))return this.removeMatching(n);if(this.list)return this.list.remove(n),this;var e=this.array(),t=b(e,n);return-1!==t&&e.splice(t,1),this.el.className=e.join(" "),this},n.prototype.removeMatching=function(n){for(var e=0,t=this.array();e<t.length;e++){var i=t[e];n.test(i)&&this.remove(i)}return this},n.prototype.array=function(){var n=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(k);return""===n[0]&&n.shift(),n},n}(),T={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},S=[];"undefined"!=typeof window&&"undefined"!=typeof document&&function(){var n=document.createElement("div").style;"AnimationEvent"in window||delete T.animationend.animation,"TransitionEvent"in window||delete T.transitionend.transition;for(var e in T)if(T.hasOwnProperty(e)){var t=T[e];for(var i in t)if(i in n){S.push(t[i]);break}}}();var C={addEndEventListener:function(n,e){0!==S.length?S.forEach(function(t){c(n,t,e)}):window.setTimeout(e,0)},endEvents:S,removeEndEventListener:function(n,e){0!==S.length&&S.forEach(function(t){u(n,t,e)})}},O=0!==C.endEvents.length,N=["-webkit-","-moz-","-o-","ms-",""];y.isCssAnimationSupported=O;var P,x={isAppearSupported:function(n){return n.transitionName&&n.transitionAppear||n.animation.appear},isEnterSupported:function(n){return n.transitionName&&n.transitionEnter||n.animation.enter},isDisappearSupported:function(n){return n.transitionName&&n.transitionDisappear||n.animation.disappear},isLeaveSupported:function(n){return n.transitionName&&n.transitionLeave||n.animation.leave},allowAppearCallback:function(n){return n.transitionAppear||n.animation.appear},allowEnterCallback:function(n){return n.transitionEnter||n.animation.enter},allowLeaveCallback:function(n){return n.transitionLeave||n.animation.leave},findDOMNode:v,addDisplyNone:function(n){var e=v(n);e&&e.style&&(e.style.display&&""!==e.style.display&&(n.displayCss=e.style.display),e.style.display="none")},removeDisplyNone:function(n){var e=v(n);e&&e.style&&(n.displayCss&&""!==n.displayCss&&"none"!==n.displayCss?e.style.display=n.displayCss:e.style.display="")},isDisplyShow:function(n,e){return n.showProp&&!n.disableShow&&!e.disableShow}},j={enter:"transitionEnter",appear:"transitionAppear",leave:"transitionLeave",disappear:"transitionDisappear"},K=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.componentWillUnmount=function(){this.stop()},t.prototype.togglerDisply=function(n){this.props.displyShow&&(n?x.removeDisplyNone(this):x.addDisplyNone(this))},t.prototype.componentWillEnter=function(n){x.isEnterSupported(this.props)?(this.togglerDisply(!0),this.transition("enter",n)):(this.togglerDisply(!0),n())},t.prototype.componentWillAppear=function(n){x.isAppearSupported(this.props)?(this.togglerDisply(!0),this.transition("appear",n)):(this.togglerDisply(!0),n())},t.prototype.componentWillDisappear=function(n){var e=this;x.isDisappearSupported(this.props)?this.transition("disappear",function(){e.togglerDisply(!1),n()}):(this.togglerDisply(!1),n())},t.prototype.componentWillLeave=function(n){var e=this;x.isLeaveSupported(this.props)?this.transition("leave",function(){e.togglerDisply(!1),n()}):(this.togglerDisply(!1),n())},t.prototype.transition=function(n,e){var t=this,i=x.findDOMNode(this),r=this.props,o=r.transitionName,a="object"==typeof o;this.stop();var s=function(){t.stopper&&(t.stopper=null,e())};if((O||!r.animation[n])&&o&&r[j[n]]){var p=a?o[n]:o+"-"+n,l=p+"-active";a&&o[n+"Active"]&&(l=o[n+"Active"]);var c=!0,u=null;r.onEnter&&"enter"===n?(c=!1,u=r.onEnter):r.onLeave&&"leave"===n&&(c=!1,u=r.onLeave),this.stopper=y(i,{name:p,active:l},s,c),!c&&u&&u(this,this.stop.bind(this))}else this.stopper=r.animation[n](i,s)},t.prototype.stop=function(){var n=this.stopper;n&&(this.stopper=null,n.stop())},t.prototype.render=function(){return this.props.children&&this.props.children[0]},t}(n.Component),M="rc_animate_"+Date.now();return function(n){n[n.enter=1]="enter",n[n.leave=2]="leave",n[n.appear=3]="appear",n[n.disappear=4]="disappear"}(P||(P={})),function(c){function u(e,t){var r=c.call(this,e,t)||this;r.performEnter=function(n){var e=r.childrenRefs[n];e&&(r.currentlyAnimatingKeys[n]=P.enter,r.props.onBeforeEnter&&r.props.onBeforeEnter(e),e.componentWillEnter(function(){r.handleDoneAdding(n,P.enter)}))},r.performLeave=function(n){var e=r.childrenRefs[n];e&&(r.currentlyAnimatingKeys[n]=P.leave,r.props.onBeforeLeave&&r.props.onBeforeLeave(e),e.componentWillLeave(function(){r.handleDoneLeaving(n,P.leave)}))},r.performAppear=function(n){r.childrenRefs[n]&&(r.currentlyAnimatingKeys[n]=P.appear,r.childrenRefs[n].componentWillAppear(function(){r.handleDoneAdding(n,P.appear)}))},r.performDisappear=function(n){r.childrenRefs[n]&&(r.currentlyAnimatingKeys[n]=P.disappear,r.childrenRefs[n].componentWillDisappear(function(){r.handleDoneLeaving(n,P.disappear)}))},r.handleDoneAdding=function(n,e){var t=r.props;if(delete r.currentlyAnimatingKeys[n],!t.exclusive||t===r.nextProps){var i=m(t);r.isValidChildByKey(i,n)?e===P.appear?x.allowAppearCallback(t)&&t.onEnd(n,!0):x.allowEnterCallback(t)&&(r.callLife(n,t.onAfterEnter),t.onEnd(n,!0)):r.performLeave(n)}},r.handleDoneLeaving=function(n,e){var t=r.props;if(delete r.currentlyAnimatingKeys[n],!t.exclusive||t===r.nextProps){var i=m(t);if(r.isValidChildByKey(i,n))r.performEnter(n);else{var o=r.childrenRefs[n],s=function(){e===P.leave&&x.allowLeaveCallback(t)&&(r.callLife(n,t.onAfterLeave,o),t.onEnd(n,!1))};a(r.state.children,i,t.showProp)?s():(r.state.children=i,r.forceUpdate(s))}}},r.currentlyAnimatingKeys={},r.keysToEnter=[],r.keysToLeave=[];var o=[];return i(r.props.children,function(e){p(e)&&(e.key||(e=n.cloneElement(e,{key:M})),o.push(e))}),r.state={children:o},r.childrenRefs={},r}return e(u,c),u.prototype.componentDidMount=function(){var n=this,e=this.props.showProp,t=this.state.children,r=[],o=[];e?i(t,function(n){n.attributes[e]?r.push(n):o.push(n)}):r=t,i(r,function(e){e&&n.performAppear(e.key)}),i(o,function(e){e&&n.performDisappear(e.key)})},u.prototype.componentWillReceiveProps=function(e,t){var o=this;this.nextProps=e;var a=m(e),p=this.props;p.exclusive&&i(Object.keys(this.currentlyAnimatingKeys),function(n){o.stop(n)});var c=p.showProp,u=this.currentlyAnimatingKeys,f=p.exclusive?m(p):this.state.children,d=[];c?(i(f,function(e){var t,i=e&&r(a,e.key),o=i||e;(t=i&&i.attributes[c]||!e.attributes[c]?i:n.cloneElement(o,(s={},s[c]=!0,s)))&&d.push(t);var s}),i(a,function(n){n&&r(f,n.key)||d.push(n)})):d=s(f,a),this.setState({children:d}),i(a,function(n){var e=n&&n.key;if(n&&u[e]){var t=u[e];t!==P.leave&&t!==P.disappear||l(n,f,c,e)&&(o.stop(e),o.keysToEnter.push(e))}else l(n,f,c,e)&&o.keysToEnter.push(e)}),i(f,function(n){var e=n&&n.key;if(n&&u[e]){var t=u[e];t!==P.enter&&t!==P.appear||l(n,a,c,e)&&(o.stop(e),o.keysToLeave.push(e))}else l(n,a,c,e)&&o.keysToLeave.push(e)})},u.prototype.componentDidUpdate=function(){var n=this.keysToEnter;this.keysToEnter=[],i(n,this.performEnter);var e=this.keysToLeave;this.keysToLeave=[],i(e,this.performLeave)},u.prototype.callLife=function(n,e,t){e&&e(this.childrenRefs[n]||t)},u.prototype.isValidChildByKey=function(n,e){var t=this.props.showProp;return t?o(n,e,t):r(n,e)},u.prototype.stop=function(n){var e=this.currentlyAnimatingKeys[n];delete this.currentlyAnimatingKeys[n];var t=this.childrenRefs[n];t&&(t.stop(),this.props.onAfterCancelled&&this.props.onAfterCancelled(t,e))},u.prototype.render=function(){var e=this,i=this.props;this.nextProps=i;var r=null;r=t(this.state.children,function(t){if(null===t||void 0===t)return t;if(!t.key)throw new Error("must set key for <rc-animate> children");var r={key:t.key,ref:function(n){e.childrenRefs[t.key]=n},animation:i.animation,transitionDisappear:i.transitionDisappear,transitionEnter:i.transitionEnter,transitionAppear:i.transitionAppear,transitionName:i.transitionName,transitionLeave:i.transitionLeave,onEnter:i.onEnter,onLeave:i.onLeave,displyShow:!1};return x.isDisplyShow(i,t.attributes)&&(r.displyShow=!0),n.h(K,r,t)});var o=i.component;if(o){var a=i;return"string"==typeof o&&(a=g({className:i.className,style:i.style},i.componentProps)),n.h(o,g({},a),r)}return r&&r[0]},u.defaultProps={exclusive:!1,animation:{},component:"span",componentProps:{},transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,disableShow:!1,onEnd:E,onEnter:null,onLeave:null,onAppear:E},u}(n.Component)});
