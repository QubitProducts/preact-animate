!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("preact")):"function"==typeof define&&define.amd?define(["preact"],t):n.animate=t(n.preact)}(this,function(n){"use strict";function t(n,t){function e(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}function e(n,t){var e=null;return n&&n.forEach(function(n){e||n&&n.key===t&&(e=n)}),e}function i(n,t,e){var i=null;return n&&n.forEach(function(n){if(n&&n.key===t&&n.attributes[e]){if(i)throw new Error("two child with same key for <Animate> children");i=n}}),i}function r(n,t,e){var i=n.length===t.length;return i&&n.forEach(function(n,r){var o=t[r];n&&o&&(n&&!o||!n&&o?i=!1:n.key!==o.key?i=!1:e&&n.attributes[e]!==o.attributes[e]&&(i=!1))}),i}function o(n,t){var i=[],r={},o=[];return n.forEach(function(n){n&&e(t,n.key)?o.length&&(r[n.key]=o,o=[]):o.push(n)}),t.forEach(function(n){n&&r.hasOwnProperty(n.key)&&(i=i.concat(r[n.key])),i.push(n)}),i=i.concat(o)}function a(n){return n&&n instanceof v}function s(n,t,e){n.addEventListener(t,e,!1)}function c(n,t,e){n.removeEventListener(t,e,!1)}function p(n,t){for(var e=window.getComputedStyle(n,null),i="",r=0,o=g;r<o.length;r++){var a=o[r];if(i=e.getPropertyValue(a+t))break}return i}function u(n){if(T){var t=parseFloat(p(n,"transition-delay"))||0,e=parseFloat(p(n,"transition-duration"))||0,i=parseFloat(p(n,"animation-delay"))||0,r=parseFloat(p(n,"animation-duration"))||0,o=Math.max(e+t,r+i);n.rcEndAnimTimeout=setTimeout(function(){n.rcEndAnimTimeout=null,n.rcEndListener&&n.rcEndListener()},1e3*o+200)}}function l(n){n.rcEndAnimTimeout&&(clearTimeout(n.rcEndAnimTimeout),n.rcEndAnimTimeout=null)}function f(n,t,e){var i=void 0===t?"undefined":"object"==typeof t,r=i?t.name:t,o=i?t.active:t+"-active",a=e,s=void 0,c=void 0,p=new k(n);return e&&"[object Object]"===Object.prototype.toString.call(e)&&(a=e.end,s=e.start,c=e.active),n.rcEndListener&&n.rcEndListener(),n.rcEndListener=function(t){t&&t.target!==n||(n.rcAnimTimeout&&(clearTimeout(n.rcAnimTimeout),n.rcAnimTimeout=null),l(n),p.remove(r),p.remove(o),w.removeEndEventListener(n,n.rcEndListener),n.rcEndListener=null,a&&a())},w.addEndEventListener(n,n.rcEndListener),s&&s(),p.add(r),n.rcAnimTimeout=setTimeout(function(){n.rcAnimTimeout=null,p.add(o),c&&setTimeout(c,0),u(n)},30),{stop:function(){n.rcEndListener&&n.rcEndListener()}}}function d(t){var e=[];return t.children.forEach(function(t){a(t)&&(t.key||(t=n.cloneElement(t,{key:x})),e.push(t))}),e}function h(){}const m=Object.assign||function(n){for(var t,e=1;e<arguments.length;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n};var v=n.h("a",null).constructor,y=/\s+/,E=Object.prototype.toString,A=function(n,t){if(n.indexOf)return n.indexOf(t);for(var e=0;e<n.length;++e)if(n[e]===t)return e;return-1},k=function(){function n(n){if(!n||!n.nodeType)throw new Error("A DOM element reference is required");this.el=n,this.list=n.classList}return n.prototype.add=function(n){if(this.list)return this.list.add(n),this;var t=this.array();return-1===A(t,n)&&t.push(n),this.el.className=t.join(" "),this},n.prototype.remove=function(n){if("[object RegExp]"===E.call(n))return this.removeMatching(n);if(this.list)return this.list.remove(n),this;var t=this.array(),e=A(t,n);return-1!==e&&t.splice(e,1),this.el.className=t.join(" "),this},n.prototype.removeMatching=function(n){for(var t=0,e=this.array();t<e.length;t++){var i=e[t];n.test(i)&&this.remove(i)}return this},n.prototype.array=function(){var n=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(y);return""===n[0]&&n.shift(),n},n}(),L={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},b=[];"undefined"!=typeof window&&"undefined"!=typeof document&&function(){var n=document.createElement("div").style;"AnimationEvent"in window||delete L.animationend.animation,"TransitionEvent"in window||delete L.transitionend.transition;for(var t in L)if(L.hasOwnProperty(t)){var e=L[t];for(var i in e)if(i in n){b.push(e[i]);break}}}();var w={addEndEventListener:function(n,t){0!==b.length?b.forEach(function(e){s(n,e,t)}):window.setTimeout(t,0)},endEvents:b,removeEndEventListener:function(n,t){0!==b.length&&b.forEach(function(e){c(n,e,t)})}},T=0!==w.endEvents.length,g=["-webkit-","-moz-","-o-","ms-",""];f.isCssAnimationSupported=T;var O={isAppearSupported:function(n){return n.transitionName&&n.transitionAppear||n.animation.appear},isEnterSupported:function(n){return n.transitionName&&n.transitionEnter||n.animation.enter},isLeaveSupported:function(n){return n.transitionName&&n.transitionLeave||n.animation.leave},allowAppearCallback:function(n){return n.transitionAppear||n.animation.appear},allowEnterCallback:function(n){return n.transitionEnter||n.animation.enter},allowLeaveCallback:function(n){return n.transitionLeave||n.animation.leave},findDOMNode:function(n){return!n.base&&n.vdom?n&&n.vdom&&n.vdom.base||n:n.base||n}},P={enter:"transitionEnter",appear:"transitionAppear",leave:"transitionLeave"},j=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return t(e,n),e.prototype.componentWillUnmount=function(){this.stop()},e.prototype.componentWillEnter=function(n){O.isEnterSupported(this.props)?this.transition("enter",n):n()},e.prototype.componentWillAppear=function(n){O.isAppearSupported(this.props)?this.transition("appear",n):n()},e.prototype.componentWillLeave=function(n){O.isLeaveSupported(this.props)?this.transition("leave",n):n()},e.prototype.transition=function(n,t){var e=this,i=O.findDOMNode(this),r=this.props,o=r.transitionName,a="object"==typeof o;this.stop();var s=function(){e.stopper=null,t()};if((T||!r.animation[n])&&o&&r[P[n]]){var c=a?o[n]:o+"-"+n,p=c+"-active";a&&o[n+"Active"]&&(p=o[n+"Active"]),this.stopper=f(i,{name:c,active:p},s)}else this.stopper=r.animation[n](i,s)},e.prototype.stop=function(){var n=this.stopper;n&&(this.stopper=null,n.stop())},e.prototype.render=function(){return this.props.children[0]},e}(n.Component),x="rc_animate_"+Date.now();return function(a){function s(n,t){var e=a.call(this,n,t)||this;return e.performEnter=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillEnter(e.handleDoneAdding.bind(e,n,"enter")))},e.performAppear=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillAppear(e.handleDoneAdding.bind(e,n,"appear")))},e.handleDoneAdding=function(n,t){var i=e.props;if(delete e.currentlyAnimatingKeys[n],!i.exclusive||i===e.nextProps){var r=d(i);e.isValidChildByKey(r,n)?"appear"===t?O.allowAppearCallback(i)&&(i.onAppear(n),i.onEnd(n,!0)):O.allowEnterCallback(i)&&(i.onEnter(n),i.onEnd(n,!0)):e.performLeave(n)}},e.performLeave=function(n){e.childrenRefs[n]&&(e.currentlyAnimatingKeys[n]=!0,e.childrenRefs[n].componentWillLeave(e.handleDoneLeaving.bind(e,n)))},e.handleDoneLeaving=function(n){var t=e.props;if(delete e.currentlyAnimatingKeys[n],!t.exclusive||t===e.nextProps){var i=d(t);if(e.isValidChildByKey(i,n))e.performEnter(n);else{var o=function(){O.allowLeaveCallback(t)&&(t.onLeave(n),t.onEnd(n,!1))};r(e.state.children,i,t.showProp)?o():e.setState({children:i},o)}}},e.currentlyAnimatingKeys={},e.keysToEnter=[],e.keysToLeave=[],e.state={children:d(e.props)},e.childrenRefs={},e}return t(s,a),s.prototype.componentDidMount=function(){var n=this,t=this.props.showProp,e=this.state.children;t&&(e=e.filter(function(n){return!!n.attributes[t]})),e.forEach(function(t){t&&n.performAppear(t.key)})},s.prototype.componentWillReceiveProps=function(t,r){var a=this;this.nextProps=t;var s=d(t),c=this.props;c.exclusive&&Object.keys(this.currentlyAnimatingKeys).forEach(function(n){a.stop(n)});var p=c.showProp,u=this.currentlyAnimatingKeys,l=c.exclusive?d(c):this.state.children,f=[];p?(l.forEach(function(t){var i,r=t&&e(s,t.key);(i=r&&r.attributes[p]||!t.attributes[p]?r:n.cloneElement(r||t,(o={},o[p]=!0,o)))&&f.push(i);var o}),s.forEach(function(n){n&&e(l,n.key)||f.push(n)})):f=o(l,s),this.setState({children:f}),s.forEach(function(n){var t=n&&n.key;if(!n||!u[t]){var r=n&&e(l,t);if(p){var o=n.attributes[p];r?!i(l,t,p)&&o&&a.keysToEnter.push(t):o&&a.keysToEnter.push(t)}else r||a.keysToEnter.push(t)}}),l.forEach(function(n){var t=n&&n.key;if(!n||!u[t]){var r=n&&e(s,t);if(p){var o=n.attributes[p];r?!i(s,t,p)&&o&&a.keysToLeave.push(t):o&&a.keysToLeave.push(t)}else r||a.keysToLeave.push(t)}})},s.prototype.componentDidUpdate=function(){var n=this.keysToEnter;this.keysToEnter=[],n.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},s.prototype.isValidChildByKey=function(n,t){var r=this.props.showProp;return r?i(n,t,r):e(n,t)},s.prototype.stop=function(n){delete this.currentlyAnimatingKeys[n];var t=this.childrenRefs[n];t&&t.stop()},s.prototype.render=function(){var t=this,e=this.props;this.nextProps=e;var i=this.state.children,r=null;i&&(r=i.map(function(i){if(null===i||void 0===i)return i;if(!i.key)throw new Error("must set key for <rc-animate> children");return n.h(j,{key:i.key,ref:function(n){t.childrenRefs[i.key]=n},animation:e.animation,transitionEnter:e.transitionEnter,transitionAppear:e.transitionAppear,transitionName:e.transitionName,transitionLeave:e.transitionLeave},i)}));var o=e.component;if(o){var a=e;return"string"==typeof o&&(a=m({className:e.className,style:e.style},e.componentProps)),n.h(o,m({},a),r)}return r[0]||null},s.defaultProps={animation:{},component:"span",componentProps:{},transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,onEnd:h,onEnter:h,onLeave:h,onAppear:h},s}(n.Component)});
