{"version":3,"file":"preact-animate-esm.js","sources":["../src/ChildrenUtils.ts","../src/class-list.ts","../src/Event.ts","../src/css-animation.ts","../src/util.ts","../src/AnimateChild.ts","../src/Animate.ts"],"sourcesContent":["import { h } from \"preact\";\n\nexport function arrayMap(children: any[] | undefined, callback: (item: any, index?: number, arr?: any[]) => any, ctx?: any) {\n    if (children == null) {\n        return null;\n    }\n    if (ctx && ctx !== children) {\n        callback = callback.bind(ctx);\n    }\n    return Array.prototype.map.call(children, callback);\n}\nexport function forEach(children: any[] | undefined, callback: (item: any, index?: number, arr?: any[]) => any, ctx?: any) {\n    if (children == null) {\n        return null;\n    }\n    if (ctx && ctx !== children) {\n        callback = callback.bind(ctx);\n    }\n    return Array.prototype.forEach.call(children, callback);\n}\n\nexport function findChildInChildrenByKey(children, key) {\n    let ret = null;\n    forEach(children, (child) => {\n        if (ret) {\n            return;\n        }\n        if (child && child.key === key) {\n            ret = child;\n        }\n    });\n    return ret;\n}\n\nexport function findShownChildInChildrenByKey(children, key, showProp) {\n    let ret = null;\n    forEach(children, (child) => {\n        if (child && child.key === key && child.attributes[showProp]) {\n            if (ret) {\n                throw new Error(\"two child with same key for <Animate> children\");\n            }\n            ret = child;\n        }\n    });\n    return ret;\n}\n\nexport function findHiddenChildInChildrenByKey(children, key, showProp) {\n    let found = false;\n    forEach(children, (child) => {\n        if (found) {\n            return;\n        }\n        found = child && child.key === key && !child.attributes[showProp];\n    });\n    return found;\n}\n\nexport function isSameChildren(c1, c2, showProp) {\n    let same = c1.length === c2.length;\n    if (same) {\n        forEach(c1, (child, index) => {\n            const child2 = c2[index];\n            if (child && child2) {\n                if ((child && !child2) || (!child && child2)) {\n                    same = false;\n                } else if (child.key !== child2.key) {\n                    same = false;\n                } else if (showProp && child.attributes[showProp] !== child2.attributes[showProp]) {\n                    same = false;\n                }\n            }\n        });\n    }\n    return same;\n}\n\nexport function mergeChildren(prev, next) {\n    let ret = [];\n\n    // For each key of `next`, the list of keys to insert before that key in\n    // the combined list\n    const nextChildrenPending = {};\n    let pendingChildren = [];\n    forEach(prev, (child) => {\n        if (child && findChildInChildrenByKey(next, child.key)) {\n            if (pendingChildren.length) {\n                nextChildrenPending[child.key] = pendingChildren;\n                pendingChildren = [];\n            }\n        } else {\n            pendingChildren.push(child);\n        }\n    });\n\n    forEach(next, (child) => {\n        if (child && nextChildrenPending.hasOwnProperty(child.key)) {\n            ret = ret.concat(nextChildrenPending[child.key]);\n        }\n        ret.push(child);\n    });\n    ret = ret.concat(pendingChildren);\n\n    return ret;\n}\n\nconst VNode = h(\"a\", null).constructor;\n\nexport function isValidElement(element) {\n    return element && (element instanceof VNode);\n}\n\nexport function isChildrenShow(child, children, showProp, key) {\n    const has = child && findChildInChildrenByKey(children, key);\n    let status = false;\n    if (showProp) {\n        const showInNow = child.attributes[showProp];\n        if (has) {\n            const showInNext = findShownChildInChildrenByKey(children, key, showProp);\n            if (!showInNext && showInNow) {\n                status = true;\n            }\n        } else if (showInNow) {\n            status = true;\n        }\n    } else if (!has) {\n        status = true;\n    }\n    return status;\n}\n\n// export function isAnimateShow(child, children, showProp, key) {\n//     const has = child && findChildInChildrenByKey(children, key);\n//     let status = false;\n//     if (showProp) {\n//         const showInNow = child.attributes[showProp];\n//         if (has) {\n//             const showInNext = findShownChildInChildrenByKey(children, key, showProp);\n//             if (showInNext && showInNow) {\n//                 status = true;\n//             }\n//         } else if (showInNow) {\n//             status = true;\n//         }\n//     } else if (!has) {\n//         status = true;\n//     }\n//     return status;\n// }\n","const re = /\\s+/;\nconst toString = Object.prototype.toString;\n\nconst index = function _(arr, obj){\n    if (arr.indexOf) {\n        return arr.indexOf(obj);\n    }\n    for (let i = 0; i < arr.length; ++i) {\n        if (arr[i] === obj) {\n            return i;\n        }\n    }\n    return -1;\n};\n\nexport default class ClassList {\n    public el: Element| HTMLElement;\n    public list: any;\n    constructor(node: Element| HTMLElement) {\n        if (!node || !node.nodeType) {\n            throw new Error(\"A DOM element reference is required\");\n        }\n        this.el = node;\n        this.list = node.classList;\n    }\n    public add(name: string) {\n        // classList\n        if (this.list) {\n            this.list.add(name);\n            return this;\n        }\n        // fallback\n        const arr = this.array();\n        const i = index(arr, name);\n        if (i === -1) {\n            arr.push(name);\n        }\n        this.el.className = arr.join(\" \");\n        return this;\n    }\n    public remove(name) {\n        if (\"[object RegExp]\" === toString.call(name)) {\n          return this.removeMatching(name);\n        }\n        // classList\n        if (this.list) {\n          this.list.remove(name);\n          return this;\n        }\n        // fallback\n        const arr = this.array();\n        const i = index(arr, name);\n        if (i !== -1) {\n            arr.splice(i, 1);\n        }\n        this.el.className = arr.join(\" \");\n        return this;\n    }\n    public removeMatching(pre: RegExp) {\n        const arr = this.array();\n        for (const i of arr) {\n            if (pre.test(i)) {\n                this.remove(i);\n            }\n        }\n        return this;\n    }\n    public array() {\n        const className = this.el.getAttribute(\"class\") || \"\";\n        const str = className.replace(/^\\s+|\\s+$/g, \"\");\n        const arr = str.split(re);\n        if (\"\" === arr[0]) {\n            arr.shift();\n        }\n        return arr;\n      }\n}\n","const EVENT_NAME_MAP = {\n    transitionend: {\n        transition: \"transitionend\",\n        WebkitTransition: \"webkitTransitionEnd\",\n        MozTransition: \"mozTransitionEnd\",\n        OTransition: \"oTransitionEnd\",\n        msTransition: \"MSTransitionEnd\",\n    },\n    animationend: {\n        animation: \"animationend\",\n        WebkitAnimation: \"webkitAnimationEnd\",\n        MozAnimation: \"mozAnimationEnd\",\n        OAnimation: \"oAnimationEnd\",\n        msAnimation: \"MSAnimationEnd\",\n    },\n};\n\nconst endEvents = [];\n\nfunction detectEvents() {\n    const testEl = document.createElement(\"div\");\n    const style = testEl.style;\n\n    if (!(\"AnimationEvent\" in window)) {\n        delete EVENT_NAME_MAP.animationend.animation;\n    }\n\n    if (!(\"TransitionEvent\" in window)) {\n        delete EVENT_NAME_MAP.transitionend.transition;\n    }\n\n    for (const baseEventName in EVENT_NAME_MAP) {\n        if (EVENT_NAME_MAP.hasOwnProperty(baseEventName)) {\n            const baseEvents = EVENT_NAME_MAP[baseEventName];\n            for (const styleName in baseEvents) {\n                if (styleName in style) {\n                    endEvents.push(baseEvents[styleName]);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nif (typeof window !== \"undefined\" && typeof document !== \"undefined\") {\n    detectEvents();\n}\n\nfunction addEventListener(node, eventName, eventListener) {\n    node.addEventListener(eventName, eventListener, false);\n}\nfunction removeEventListener(node, eventName, eventListener) {\n    node.removeEventListener(eventName, eventListener, false);\n}\n\nconst TransitionEvents = {\n    addEndEventListener: function addEndEventListener(node, eventListener) {\n        if (endEvents.length === 0) {\n            window.setTimeout(eventListener, 0);\n            return;\n        }\n        endEvents.forEach(function _(endEvent) {\n            addEventListener(node, endEvent, eventListener);\n        });\n    },\n    endEvents,\n    removeEndEventListener: function removeEndEventListener(node, eventListener) {\n        if (endEvents.length === 0) {\n            return;\n        }\n        endEvents.forEach(function _(endEvent) {\n            removeEventListener(node, endEvent, eventListener);\n        });\n    },\n};\n\nexport default TransitionEvents;\n","import ClassList from \"./class-list\";\nimport Event from \"./Event\";\n\ntype voidFun = () => void;\n\ninterface IEndCall {\n    end: voidFun;\n    start: voidFun;\n    active: voidFun;\n}\ninterface ITransition {\n    active: string;\n    name: string;\n}\nexport const isCssAnimationSupported = Event.endEvents.length !== 0;\nconst prefixes = [\"-webkit-\", \"-moz-\", \"-o-\", \"ms-\", \"\"];\n\nfunction getStyleProperty(node, name) {\n    const style = window.getComputedStyle(node, null);\n    let ret = \"\";\n    for (const i of prefixes) {\n        ret = style.getPropertyValue(i + name);\n        if (ret) {\n            break;\n        }\n    }\n    return ret;\n}\n\nfunction fixBrowserByTimeout(node) {\n    if (isCssAnimationSupported) {\n        const transitionDelay = parseFloat(getStyleProperty(node, \"transition-delay\")) || 0;\n        const transitionDuration = parseFloat(getStyleProperty(node, \"transition-duration\")) || 0;\n        const animationDelay = parseFloat(getStyleProperty(node, \"animation-delay\")) || 0;\n        const animationDuration = parseFloat(getStyleProperty(node, \"animation-duration\")) || 0;\n        const time = Math.max(transitionDuration + transitionDelay, animationDuration + animationDelay);\n        // sometimes, browser bug\n        node.rcEndAnimTimeout = setTimeout(function _() {\n            node.rcEndAnimTimeout = null;\n            if (node.rcEndListener) {\n                node.rcEndListener();\n            }\n        }, time * 1000 + 200);\n    }\n}\n\nfunction clearBrowserBugTimeout(node) {\n    if (node.rcEndAnimTimeout) {\n        clearTimeout(node.rcEndAnimTimeout);\n        node.rcEndAnimTimeout = null;\n    }\n}\nfunction cssAnimate(\n    node: Element | HTMLElement,\n    transitionName: string | ITransition,\n    endCallback: voidFun | IEndCall,\n    isAddEvent: boolean,\n): { stop: voidFun } {\n    const nameIsObj = typeof transitionName === \"undefined\" ? \"undefined\" : typeof transitionName === \"object\";\n    const className = nameIsObj ? (transitionName as ITransition).name : (transitionName as string);\n    const activeClassName = nameIsObj ? (transitionName as ITransition).active : transitionName + \"-active\";\n    let end = endCallback;\n    let start = void 0;\n    let active = void 0;\n    const nodeClasses = new ClassList(node);\n\n    if (endCallback && Object.prototype.toString.call(endCallback) === \"[object Object]\") {\n        end = (endCallback as IEndCall).end;\n        start = (endCallback as IEndCall).start;\n        active = (endCallback as IEndCall).active;\n    }\n    if ((node as any).rcEndListener) {\n        (node as any).rcEndListener();\n    }\n    (node as any).rcEndListener = function _(e) {\n        if (e && e.target !== node) {\n            return;\n        }\n        if ((node as any).rcAnimTimeout) {\n            clearTimeout((node as any).rcAnimTimeout);\n            (node as any).rcAnimTimeout = null;\n        }\n        clearBrowserBugTimeout(node);\n        nodeClasses.remove(className);\n        nodeClasses.remove(activeClassName);\n        if (isAddEvent) {\n            Event.removeEndEventListener(node, (node as any).rcEndListener);\n        }\n        (node as any).rcEndListener = null;\n        if (end) {\n            (end as voidFun)();\n        }\n    };\n    if (isAddEvent) {\n        Event.addEndEventListener(node, (node as any).rcEndListener);\n    }\n    if (start) {\n        start();\n    }\n    nodeClasses.add(className);\n    (node as any).rcAnimTimeout = setTimeout(function _() {\n        (node as any).rcAnimTimeout = null;\n        nodeClasses.add(activeClassName);\n        if (active) {\n            setTimeout(active, 0);\n        }\n\n        if (isAddEvent) {\n            fixBrowserByTimeout(node);\n            // 30ms for firefox\n        }\n    }, 30);\n    return {\n        stop: function stop() {\n            if ((node as any).rcEndListener) {\n                (node as any).rcEndListener();\n            }\n        },\n    };\n}\n(cssAnimate as any).isCssAnimationSupported = isCssAnimationSupported;\n\nexport default cssAnimate;\n","import preact, { Component } from \"preact\";\n\nexport function isAppearSupported(props: any) {\n    return props.transitionName && props.transitionAppear || props.animation.appear;\n}\nexport function isEnterSupported(props: any) {\n    return props.transitionName && props.transitionEnter || props.animation.enter;\n}\nexport function isLeaveSupported(props: any) {\n    return props.transitionName && props.transitionLeave || props.animation.leave;\n}\nexport function isDisappearSupported(props: any) {\n    return props.transitionName && props.transitionDisappear || props.animation.disappear;\n}\nexport function allowAppearCallback(props: any) {\n    return props.transitionAppear || props.animation.appear;\n}\nexport function allowEnterCallback(props: any) {\n    return props.transitionEnter || props.animation.enter;\n}\nexport function allowLeaveCallback(props: any) {\n    return props.transitionLeave || props.animation.leave;\n}\nexport function findDOMNode(component: Component<any, any>) {\n    if (typeof preact.findDOMNode === \"function\") {\n        return preact.findDOMNode(component);\n    } else {\n        return (component as any).base || component;\n    }\n}\nexport function addDisplyNone(component: any) {\n    const node = findDOMNode(component);\n    if (node && node.style) {\n        if (node.style.display && node.style.display !== \"\") {\n            component.displayCss = node.style.display;\n        }\n        node.style.display = \"none\";\n    }\n}\nexport function removeDisplyNone(component: any) {\n    const node = findDOMNode(component);\n    if (node && node.style) {\n        if (component.displayCss && component.displayCss !== \"\" && component.displayCss !== \"none\") {\n            node.style.display = component.displayCss;\n        } else {\n            node.style.display = \"\";\n        }\n    }\n}\nexport function isDisplyShow(props, childProps) {\n    return props.showProp && (!props.disableShow && !childProps.disableShow);\n}\n\nexport default {\n    isAppearSupported,\n    isEnterSupported,\n    isDisappearSupported,\n    isLeaveSupported,\n    allowAppearCallback,\n    allowEnterCallback,\n    allowLeaveCallback,\n    findDOMNode,\n    addDisplyNone,\n    removeDisplyNone,\n    isDisplyShow,\n};\n// export default util;\n","import { Component } from \"preact\";\nimport cssAnimate, { isCssAnimationSupported } from \"./css-animation\";\nimport animUtil from \"./util\";\nimport { forEach } from \"./ChildrenUtils\";\n\nconst transitionMap = {\n    enter: \"transitionEnter\",\n    appear: \"transitionAppear\",\n    leave: \"transitionLeave\",\n    disappear: \"transitionDisappear\",\n};\n\ninterface IAnimateChildProps {\n    key: string;\n    animation: object;\n    transitionName: string|object;\n    transitionEnter: boolean;\n    transitionAppear: boolean;\n    transitionLeave: boolean;\n    transitionDisappear: boolean;\n    displyShow: boolean;\n    onEnter: (child: AnimateChild, callBack: () => void) => void;\n    onLeave: (child: AnimateChild, callBack: () => void) => void;\n}\n\nexport default class AnimateChild extends Component<IAnimateChildProps, any> {\n    public stopper: null | { stop: () => void};\n    public displayCss: string | undefined;\n    public transitionName: any = null;\n    public componentWillUnmount() {\n        this.stop();\n    }\n    private togglerDisply(show: boolean) {\n        if (this.props.displyShow) {\n            if (show) {\n                animUtil.removeDisplyNone(this);\n            } else {\n                animUtil.addDisplyNone(this);\n            }\n        }\n    }\n    public componentWillEnter(done: () => void) {\n        if (animUtil.isEnterSupported(this.props)) {\n            this.togglerDisply(true);\n            this.transition(\"enter\", done);\n        } else {\n            this.togglerDisply(true);\n            done();\n        }\n    }\n\n    public componentWillAppear(done: () => void) {\n        if (animUtil.isAppearSupported(this.props)) {\n            this.togglerDisply(true);\n            this.transition(\"appear\", done);\n        } else {\n            this.togglerDisply(true);\n            done();\n        }\n    }\n    public componentWillDisappear(done: () => void) {\n        if (animUtil.isDisappearSupported(this.props)) {\n            this.transition(\"disappear\", () => {\n                this.togglerDisply(false);\n                done();\n            });\n        } else {\n            this.togglerDisply(false);\n            done();\n        }\n    }\n    public componentWillLeave(done: () => void) {\n        if (animUtil.isLeaveSupported(this.props)) {\n            this.transition(\"leave\", () => {\n                this.togglerDisply(false);\n                done();\n            });\n        } else {\n            // always sync, do not interupt with react component life cycle\n            // update hidden -> animate hidden ->\n            // didUpdate -> animate leave -> unmount (if animate is none)\n            this.togglerDisply(false);\n            done();\n        }\n    }\n\n    private transition(animationType: string, finishCallback: () => void) {\n        const node: HTMLElement = animUtil.findDOMNode(this);\n        if (node.nodeType === 3) {\n            finishCallback();\n            return;\n        }\n        const props = this.props;\n        const childTransitionName = (\n            props.children &&\n            props.children[0] &&\n            props.children[0].attributes &&\n            props.children[0].attributes.transitionName\n        );\n        const transitionName = childTransitionName || props.transitionName;\n        const nameIsObj = typeof transitionName === \"object\";\n        this.stop();\n        const end = () => {\n            if (this.stopper) {\n                this.stopper = null;\n                finishCallback();\n            }\n        };\n        if ((isCssAnimationSupported || !props.animation[animationType]) &&\n                transitionName && props[transitionMap[animationType]]) {\n            const name = nameIsObj ? (transitionName as object)[animationType] : `${transitionName}-${animationType}`;\n            let activeName = `${name}-active`;\n            if (nameIsObj && (transitionName as object)[`${animationType}Active`]) {\n                activeName = (transitionName as object)[`${animationType}Active`];\n            }\n            let isAnimateEvent = true;\n            let propsEvent: ((child: AnimateChild, callBack: () => void) => void) | null = null;\n            if (props.onEnter && animationType === \"enter\") {\n                isAnimateEvent = false;\n                propsEvent = props.onEnter;\n            } else if (props.onLeave && animationType === \"leave\") {\n                isAnimateEvent = false;\n                propsEvent = props.onLeave;\n            }\n            this.stopper = cssAnimate(\n                node,\n                { name, active: activeName },\n                end,\n                isAnimateEvent,\n            );\n            if (!isAnimateEvent && propsEvent) {\n                propsEvent(this, this.stop.bind(this));\n            }\n        } else {\n            this.stopper = props.animation[animationType](node, end);\n        }\n    }\n\n    public stop() {\n        const stopper = this.stopper;\n        if (stopper) {\n            this.stopper = null;\n            stopper.stop();\n        }\n    }\n\n    public render() {\n        return this.props.children && this.props.children[0];\n    }\n}\n","import { h, Component, cloneElement } from \"preact\";\n// import PropTypes from \"prop-types\";\nimport {\n    mergeChildren,\n    findShownChildInChildrenByKey,\n    findChildInChildrenByKey,\n    isSameChildren,\n    isValidElement,\n    forEach,\n    arrayMap,\n    isChildrenShow,\n} from \"./ChildrenUtils\";\nimport AnimateChild from \"./AnimateChild\";\nconst defaultKey = `rc_animate_${Date.now()}`;\nimport animUtil from \"./util\";\n\nenum AnimateType {\n    enter = 1,\n    leave = 2,\n    appear = 3,\n    disappear = 4,\n}\n\nfunction getChildrenFromProps(props: IAnimateProps) {\n    const children = props.children;\n    const newChildren = [];\n    forEach(children, (child) => {\n        if (isValidElement(child)) {\n            if (!child.key) {\n                child = cloneElement(child, {\n                    key: defaultKey,\n                });\n            }\n            newChildren.push(child);\n        }\n    });\n    return newChildren;\n}\n\nfunction noop() {\n}\n\ninterface IAnimateProps {\n    component: any;\n    componentProps: object;\n    animation: object;\n    transitionName: string|object;\n    transitionEnter: boolean;\n    transitionAppear: boolean;\n    transitionLeave: boolean;\n    transitionDisappear: boolean;\n    exclusive: boolean;\n    onEnd: (key: string, exists: boolean) => void;\n    onEnter: (child: AnimateChild, callBack: () => void) => void;\n    onLeave: (child: AnimateChild, callBack: () => void) => void;\n    onAppear: (key: string) => void;\n    showProp: string;\n    disableShow?: boolean;\n    className?: string;\n    style?: string|object;\n    children: any[];\n    onAfterCancelled?: (child: AnimateChild, status: AnimateType) => any;\n    onBeforeLeave?: (child: AnimateChild) => any;\n    onAfterLeave?: (child: AnimateChild) => any;\n    onBeforeEnter?: (child: AnimateChild) => any;\n    onAfterEnter?: (child: AnimateChild) => any;\n}\ninterface IAnimateState {\n    children: any[];\n}\n\nexport default class Animate extends Component<IAnimateProps, IAnimateState> {\n    public currentlyAnimatingKeys: {\n        [key: string]: AnimateType;\n    };\n    public keysToEnter: string[];\n    public keysToLeave: string[];\n    public childrenRefs: {\n        [key: string]: AnimateChild;\n    };\n    public nextProps;\n\n    public static defaultProps = {\n        exclusive: false,\n        animation: {},\n        component: \"span\",\n        componentProps: {},\n        transitionEnter: true,\n        transitionLeave: true,\n        transitionAppear: false,\n        disableShow: false,\n        onEnd: noop,\n        onEnter: null,\n        onLeave: null,\n        onAppear: noop,\n    };\n\n    constructor(props: IAnimateProps, c) {\n        super(props, c);\n\n        this.currentlyAnimatingKeys = {};\n        this.keysToEnter = [];\n        this.keysToLeave = [];\n        // const tmpChildren = getChildrenFromProps(this.props);\n        const children = [];\n        forEach(this.props.children, (child) => {\n            if (isValidElement(child)) {\n                if (!child.key) {\n                    child = cloneElement(child, {\n                        key: defaultKey,\n                    });\n                }\n                children.push(child);\n            }\n        });\n        this.state = {\n            children,\n        };\n\n        this.childrenRefs = {};\n    }\n\n    public componentDidMount() {\n        const showProp = this.props.showProp;\n        const children = this.state.children;\n        let appearChildren = [];\n        const disappearChildren = [];\n        if (showProp) {\n            forEach(children, (child) => {\n                if (!!child.attributes[showProp]) {\n                    appearChildren.push(child);\n                } else {\n                    disappearChildren.push(child);\n                }\n            });\n        } else {\n            appearChildren = children;\n        }\n        forEach(appearChildren, (child) => {\n            if (child) {\n                this.performAppear(child.key);\n            }\n        });\n        forEach(disappearChildren, (child) => {\n            if (child) {\n                this.performDisappear(child.key);\n            }\n        });\n    }\n\n    public componentWillReceiveProps(nextProps, nextContext) {\n        this.nextProps = nextProps;\n        const nextChildren = getChildrenFromProps(nextProps);\n        const props = this.props;\n        // exclusive needs immediate response\n        if (props.exclusive) {\n            forEach(Object.keys(this.currentlyAnimatingKeys), (key) => {\n                this.stop(key);\n            });\n        }\n        const showProp = props.showProp;\n        const currentlyAnimatingKeys = this.currentlyAnimatingKeys;\n        // last props children if exclusive\n        const currentChildren = props.exclusive ?\n            getChildrenFromProps(props) : this.state.children;\n        // in case destroy in showProp mode\n        let newChildren = [];\n        if (showProp) {\n            forEach(currentChildren, (currentChild) => {\n                const nextChild = currentChild && findChildInChildrenByKey(nextChildren, currentChild.key);\n                let newChild;\n                const tmpChild = nextChild || currentChild;\n                if ((!nextChild || !nextChild.attributes[showProp]) && currentChild.attributes[showProp]) {\n                    newChild = cloneElement(tmpChild, {\n                        [showProp]: true,\n                    });\n                } else {\n                    newChild = nextChild;\n                }\n                if (newChild) {\n                    newChildren.push(newChild);\n                }\n            });\n            forEach(nextChildren, (nextChild) => {\n                if (!nextChild || !findChildInChildrenByKey(currentChildren, nextChild.key)) {\n                    newChildren.push(nextChild);\n                }\n            });\n        } else {\n            newChildren = mergeChildren(\n                currentChildren,\n                nextChildren,\n            );\n        }\n        // need render to avoid update\n        this.setState({\n            children: newChildren,\n        });\n        forEach(nextChildren, (child) => {\n            const key = child && child.key;\n            if (child && currentlyAnimatingKeys[key]) {\n                const status = currentlyAnimatingKeys[key];\n                if (status === AnimateType.leave || status === AnimateType.disappear) {\n                    if (isChildrenShow(child, currentChildren, showProp, key)) {\n                        this.stop(key);\n                        this.keysToEnter.push(key);\n                    }\n                }\n                return;\n            }\n            if (isChildrenShow(child, currentChildren, showProp, key)) {\n                this.keysToEnter.push(key);\n            }\n\n        });\n\n        forEach(currentChildren, (child) => {\n            const key = child && child.key;\n            if (child && currentlyAnimatingKeys[key]) {\n                const status = currentlyAnimatingKeys[key];\n                if (status === AnimateType.enter || status === AnimateType.appear) {\n                    if (isChildrenShow(child, nextChildren, showProp, key)) {\n                        this.stop(key);\n                        this.keysToLeave.push(key);\n                    }\n                }\n                return;\n            }\n            if (isChildrenShow(child, nextChildren, showProp, key)) {\n                this.keysToLeave.push(key);\n            }\n        });\n    }\n\n    public componentDidUpdate() {\n        const keysToEnter = this.keysToEnter;\n        this.keysToEnter = [];\n        forEach(keysToEnter, this.performEnter);\n        const keysToLeave = this.keysToLeave;\n        this.keysToLeave = [];\n        forEach(keysToLeave, this.performLeave);\n    }\n\n    public performEnter = (key) => {\n        // may already remove by exclusive\n        const activeChild = this.childrenRefs[key];\n        if (activeChild) {\n            this.currentlyAnimatingKeys[key] = AnimateType.enter;\n            if (this.props.onBeforeEnter) {\n                this.props.onBeforeEnter(activeChild);\n            }\n            activeChild.componentWillEnter(() => {\n                this.handleDoneAdding(key, AnimateType.enter);\n            });\n        }\n    }\n\n    public performLeave = (key) => {\n        // may already remove by exclusive\n        const activeChild = this.childrenRefs[key];\n        if (activeChild) {\n            this.currentlyAnimatingKeys[key] = AnimateType.leave;\n            if (this.props.onBeforeLeave) {\n                this.props.onBeforeLeave(activeChild);\n            }\n            activeChild.componentWillLeave(() => {\n                this.handleDoneLeaving(key, AnimateType.leave);\n            });\n        }\n    }\n\n    public performAppear = (key) => {\n        if (this.childrenRefs[key]) {\n            this.currentlyAnimatingKeys[key] = AnimateType.appear;\n            this.childrenRefs[key].componentWillAppear(() => {\n                this.handleDoneAdding(key, AnimateType.appear);\n            });\n        }\n    }\n\n    public performDisappear = (key) => {\n        if (this.childrenRefs[key]) {\n            this.currentlyAnimatingKeys[key] = AnimateType.disappear;\n            this.childrenRefs[key].componentWillDisappear(() => {\n                this.handleDoneLeaving(key, AnimateType.disappear);\n            });\n        }\n    }\n\n    private callLife(key: string, callBack, child?) {\n        if (callBack) {\n            const activeChild = this.childrenRefs[key];\n            callBack(activeChild || child);\n        }\n    }\n\n    public handleDoneAdding = (key: string, type: AnimateType) => {\n        const props = this.props;\n        delete this.currentlyAnimatingKeys[key];\n        // if update on exclusive mode, skip check\n        if (props.exclusive && props !== this.nextProps) {\n            return;\n        }\n        const currentChildren = getChildrenFromProps(props);\n        if (!this.isValidChildByKey(currentChildren, key)) {\n            // exclusive will not need this\n            this.performLeave(key);\n        } else {\n            if (type === AnimateType.appear) {\n                if (animUtil.allowAppearCallback(props)) {\n                    // props.onAppear(key);\n                    props.onEnd(key, true);\n                }\n            } else {\n                if (animUtil.allowEnterCallback(props)) {\n                    // props.onEnter(key);\n                    this.callLife(key, props.onAfterEnter);\n                    props.onEnd(key, true);\n                }\n            }\n        }\n    }\n\n    public handleDoneLeaving = (key: string, type: AnimateType) => {\n        const props = this.props;\n        delete this.currentlyAnimatingKeys[key];\n        // if update on exclusive mode, skip check\n        if (props.exclusive && props !== this.nextProps) {\n            return;\n        }\n        const currentChildren = getChildrenFromProps(props);\n        // in case state change is too fast\n        if (this.isValidChildByKey(currentChildren, key)) {\n            this.performEnter(key);\n        } else {\n            const activeChild = this.childrenRefs[key];\n            const end = () => {\n                if (type === AnimateType.leave) {\n                    if (animUtil.allowLeaveCallback(props)) {\n                        this.callLife(key, props.onAfterLeave, activeChild);\n                        props.onEnd(key, false);\n                    }\n                }\n            };\n            if (\n                !isSameChildren(\n                    this.state.children,\n                    currentChildren,\n                    props.showProp,\n                )\n            ) {\n                this.state.children = currentChildren;\n                this.forceUpdate(end);\n            } else {\n                end();\n            }\n        }\n    }\n\n    public isValidChildByKey(currentChildren, key) {\n        const showProp = this.props.showProp;\n        if (showProp) {\n            return findShownChildInChildrenByKey(currentChildren, key, showProp);\n        }\n        return findChildInChildrenByKey(currentChildren, key);\n    }\n\n    public stop(key: string) {\n        const animateStatus = this.currentlyAnimatingKeys[key];\n        delete this.currentlyAnimatingKeys[key];\n        const component = this.childrenRefs[key];\n        if (component) {\n            component.stop();\n            if (this.props.onAfterCancelled) {\n                this.props.onAfterCancelled(component, animateStatus);\n            }\n        }\n    }\n\n    public render() {\n        const props = this.props;\n        this.nextProps = props;\n        const stateChildren = this.state.children;\n        let children = null;\n        children = arrayMap(stateChildren, (child) => {\n            if (child === null || child === undefined) {\n                return child;\n            }\n            if (!child.key) {\n                throw new Error(\"must set key for <rc-animate> children\");\n            }\n            const refFun = (node) => {\n                this.childrenRefs[child.key] = node;\n            };\n            const childProps = {\n                key: child.key,\n                ref: refFun,\n                animation: props.animation,\n                transitionDisappear: props.transitionDisappear,\n                transitionEnter: props.transitionEnter,\n                transitionAppear: props.transitionAppear,\n                transitionName: props.transitionName,\n                transitionLeave: props.transitionLeave,\n                onEnter: props.onEnter,\n                onLeave: props.onLeave,\n                displyShow: false,\n            };\n            if (animUtil.isDisplyShow(props, child.attributes)) {\n                childProps.displyShow = true;\n            }\n            return h(\n                (AnimateChild as any),\n                childProps,\n                child,\n            );\n        });\n        const _Component = props.component;\n        if (_Component) {\n            let passedProps: any = props;\n            if (typeof _Component === \"string\") {\n                passedProps = {\n                    className: props.className,\n                    style: props.style,\n                    ...props.componentProps,\n                };\n            }\n            return h(_Component, {...passedProps}, children);\n        }\n        return children && children[0];\n    }\n}\n"],"names":["Event"],"mappings":"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"}